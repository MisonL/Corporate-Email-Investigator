# 企业邮箱批量获取工具

这是一个使用 Python 编写的自动化脚本，旨在通过调用 `gemini-cli` 命令行工具，批量查询 Excel 文件中指定公司的官方联系邮箱，并将结果写回原文件。

## ✨ 功能特性

- **自动化处理**: 自动读取 Excel 文件，并遍历公司列表进行查询。
- **智能查询**: 利用 Gemini 的强大能力和优化的搜索策略提示词，最大化提升查找成功率。
- **实时保存**: 每处理完一条记录后立即保存结果到 Excel，确保数据安全。
- **断点续传**: 自动跳过已经获取到邮箱的记录，可以随时中断和恢复任务。
- **精细化日志**:
    - 在控制台实时显示完整的处理过程。
    - 将所有未找到邮箱的公司记录到 `not_found_log.log` 中，并提供最终的汇总报告，方便复盘。

## ⚙️ 安装与配置

在运行本脚本前，您需要完成 **2个部分** 的环境配置：`gemini-cli` 的安装与配置，以及本项目 Python 依赖的安装。

### **第一部分：安装与配置 `gemini-cli`**

本工具依赖于 Google 的 `gemini-cli` 命令行程序。

#### 1. 前提条件：安装 Node.js

`gemini-cli` 是一个 Node.js 包，因此您需要先确保系统中已安装 Node.js (推荐LTS版本) 和 npm。您可以从 [Node.js 官网](https://nodejs.org/) 下载安装。

#### 2. 安装 `gemini-cli`

打开您的终端，执行以下命令进行全局安装：

```bash
npm install -g @google-gemini/cli
```

#### 3. 配置认证 (重要)

安装完成后，您需要授权 `gemini-cli` 访问您的 Google 账户。

**推荐方式：交互式登录**

这是最简单、最直接的认证方法。

1.  在终端中直接运行 `gemini` 命令：
    ```bash
    gemini
    ```
2.  程序会首次运行会提示您选择认证方式。
3.  按**回车 (Enter)** 键选择默认的 **"1. Login with Google"**。
4.  之后，`gemini-cli` 会提供一个链接，并要求您在浏览器中打开它，完成 Google 账户的登录和授权流程。
5.  授权成功后，您的登录信息会被保存下来，后续即可正常使用。

#### 4. 网络注意事项 (重要)

如果您所在的地区无法直接访问 Google 服务，您需要使用网络代理。

由于 `gemini-cli` 是一个命令行工具，普通的系统 HTTP/HTTPS 代理可能无法接管其网络流量。因此，**强烈推荐使用支持 TUN 模式（虚拟网卡）的代理工具**，以确保终端的网络请求能被正确代理。

- **推荐工具示例**: [Clash Verge Rev](https://github.com/clash-verge-rev/clash-verge-rev)
- **使用方法**: 在运行 `gemini` 命令或本项目的 `main.py` 脚本**之前**，请先启动您的代理工具，并**开启 TUN 模式**。

### **第二部分：安装本项目依赖**

1.  确保您已安装 Python 3.10 或更高版本。
2.  在本项目根目录下，打开终端，运行以下命令来安装所有必需的 Python 库：

    ```bash
    pip install -r requirements.txt
    ```

## 🚀 使用方法

1.  **准备 Excel 文件**:
    *   确保项目根目录下存在名为 `data.xlsx` 的文件。
    *   文件中必须包含一个名为 `Sheet1` 的工作表。
    *   工作表中必须包含 `company_name` (公司英文名) 和/或 `company_name_tc` (公司中文名) 列。
2.  **运行脚本**:
    *   完成所有安装与配置后，在项目根目录下打开终端，执行：

    ```bash
    python main.py
    ```
3.  **查看结果**:
    *   程序运行期间，处理结果会实时保存在 `data.xlsx` 的 `Email` 列中。
    *   所有未找到邮箱的公司，以及最终的统计报告，都会保存在 `not_found_log.log` 文件中。
